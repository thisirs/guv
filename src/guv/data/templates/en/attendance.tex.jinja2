% -*- mode: latex; -*-
\documentclass[12pt]{article}

% Font selection (XeLaTeX or LuaLaTeX)
\usepackage{fontspec}
\usepackage{unicode-math}

% Libertinus fonts
\setmainfont{Libertinus Serif}
\setsansfont{Libertinus Sans}
\setmonofont{Libertinus Mono}
\setmathfont{Libertinus Math}

\usepackage[english]{babel}
\usepackage[a4paper,left=2cm,right=2cm,top=1cm,bottom=2cm]{geometry}
\usepackage{longtable}
\usepackage{booktabs}
\usepackage{array}

% See https://tex.stackexchange.com/q/85335
\makeatletter
\renewcommand \dotfill {\leavevmode \cleaders \hb@xt@ 1em{\hss .\hss }\hfill \kern \z@}
\makeatother

\begin{document}

\noindent\hrulefill
\begin{center}
  \begin{Huge}
    \textbf{(((title | escape_tex)))}
  \end{Huge}
  ((* if group *))
  \par\smallskip
  \textbf{(((group | escape_tex)))}
  ((* endif *))
\end{center}
\noindent\hrulefill\bigskip

\begin{tabular}{@{}>{\bfseries}l@{\hspace{0.5cm}}p{4cm}@{}
                @{\hspace{3cm}} % Add horizontal space between the two columns
                >{\bfseries}l@{\hspace{0.5cm}}p{4cm}@{}}
Semester: & ((* if planning *))\underline{\makebox[4cm][c]{(((planning | escape_tex)))}}((* else *))\underline{\hspace{4cm}}((* endif *)) &
Course:   & ((* if uv *))\underline{\makebox[4cm][c]{(((uv | escape_tex)))}}((* else *))\underline{\hspace{4cm}}((* endif *)) \\[0.5em]
Date:     & ((* if date *))\underline{\makebox[4cm][c]{(((date | escape_tex)))}}((* else *))\underline{\hspace{4cm}}((* endif *)) &
Exam:     & ((* if exam *))\underline{\makebox[4cm][c]{(((exam | escape_tex)))}}((* else *))\underline{\hspace{4cm}}((* endif *)) \\
\end{tabular}
\bigskip


\newcounter{stunum}
\begin{longtable}{@{}r p{4.5in} p{2in}@{}}
  \toprule
  \textbf{\#} & \textbf{Student name} & \textbf{Signature} \\
  \midrule\smallskip
  \endfirsthead

  \toprule
  \textbf{\#} & \textbf{Student name} & \textbf{Signature} \\
  \midrule\smallskip
  \endhead

  ((* if blank *))
  ((* for i in range(num) *))
  \stepcounter{stunum}\arabic{stunum}. & \underline{\hspace{4.5in}} & \underline{\hspace{2in}} \\[1em]
  ((* endfor *))
  ((* else *))
  ((* for student in students *))
  \stepcounter{stunum}\arabic{stunum}. & (((student['name'] | escape_tex)))\dotfill & \underline{\hspace{2in}} \\[1em]
  ((* endfor *))
  ((* endif *))
  ((* for i in range(extra) *))
  \stepcounter{stunum}\arabic{stunum}. & \underline{\hspace{4.5in}} & \underline{\hspace{2in}} \\[1em]
  ((* endfor *))
\end{longtable}

\end{document}

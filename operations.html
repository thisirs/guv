<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="prev" title="Tasks" href="tasks.html" />

    <!-- Generated with Sphinx 8.2.1 and Furo 2024.08.06 -->
        <title>Aggregating functions for DOCS - guv documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">guv  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">guv  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">guv</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tasks.html">Tasks</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Aggregating functions for <code class="docutils literal notranslate"><span class="pre">DOCS</span></code></a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/operations.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="aggregating-functions-for-docs">
<h1>Aggregating functions for <code class="docutils literal notranslate"><span class="pre">DOCS</span></code><a class="headerlink" href="#aggregating-functions-for-docs" title="Link to this heading">¶</a></h1>
<section id="aggregating-file-to-base-docs-file">
<h2>Aggregating file to base <code class="docutils literal notranslate"><span class="pre">DOCS</span></code> file<a class="headerlink" href="#aggregating-file-to-base-docs-file" title="Link to this heading">¶</a></h2>
<dl class="py method">
<dt class="sig sig-object py" id="guv.helpers.Documents.aggregate">
<span class="sig-prename descclassname"><span class="pre">Documents.</span></span><span class="sig-name descname"><span class="pre">aggregate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_on</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">callable</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_on</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">callable</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">merge_policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'merge'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'keep'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'erase'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'replace'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'fill_na'</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'merge'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preprocessing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Operation</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">postprocessing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Operation</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kw_read</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#guv.helpers.Documents.aggregate" title="Link to this definition">¶</a></dt>
<dd><p>Aggregation of a table from an Excel/CSV file.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">left_on</span></code> and <code class="docutils literal notranslate"><span class="pre">right_on</span></code> arguments are column names used to perform a join:
<code class="docutils literal notranslate"><span class="pre">left_on</span></code> is a column in the central file <code class="docutils literal notranslate"><span class="pre">effectif.xlsx</span></code>, and <code class="docutils literal notranslate"><span class="pre">right_on</span></code> is
a column from the file to aggregate. For more complex joins, you can use the
<code class="xref py py-func docutils literal notranslate"><span class="pre">guv.helpers.id_slug()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">guv.helpers.concat()</span></code> functions (see Examples).
If <code class="docutils literal notranslate"><span class="pre">left_on</span></code> and <code class="docutils literal notranslate"><span class="pre">right_on</span></code> have the same value, you can simply specify <code class="docutils literal notranslate"><span class="pre">on</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">subset</span></code> is a list of columns to keep if you don’t want to aggregate all columns.
<code class="docutils literal notranslate"><span class="pre">drop</span></code> is a list of columns to remove. <code class="docutils literal notranslate"><span class="pre">rename</span></code> is a dictionary of columns to rename.
<code class="docutils literal notranslate"><span class="pre">read_method</span></code> is a <em>callable</em> used to read the file and is called with <code class="docutils literal notranslate"><span class="pre">kw_read</span></code>.
<code class="docutils literal notranslate"><span class="pre">preprocessing</span></code> and <code class="docutils literal notranslate"><span class="pre">postprocessing</span></code> are <em>callables</em> that take a <em>DataFrame</em> as
input and return a processed one — they are applied before and after the aggregation, respectively.
<code class="docutils literal notranslate"><span class="pre">merge_policy</span></code> indicates how to handle merging columns with the same name in
<code class="docutils literal notranslate"><span class="pre">effectif.xlsx</span></code> and the aggregated file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Path to the CSV/Excel file to aggregate.</p></li>
<li><p><strong>left_on</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Column name in the <code class="docutils literal notranslate"><span class="pre">effectif.xlsx</span></code> file used for the join.
You can also use functions like <code class="xref py py-func docutils literal notranslate"><span class="pre">guv.helpers.id_slug()</span></code> and
<code class="xref py py-func docutils literal notranslate"><span class="pre">guv.helpers.concat()</span></code> for multi-column joins.</p></li>
<li><p><strong>right_on</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Column name in the file to aggregate used for the join.
Functions like <code class="xref py py-func docutils literal notranslate"><span class="pre">guv.helpers.id_slug()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">guv.helpers.concat()</span></code>
are also supported.</p></li>
<li><p><strong>on</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Shortcut when <code class="docutils literal notranslate"><span class="pre">left_on</span></code> and <code class="docutils literal notranslate"><span class="pre">right_on</span></code> are the same.</p></li>
<li><p><strong>subset</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code>, optional) – List of columns to include. By default, all columns are incorporated.</p></li>
<li><p><strong>drop</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code>, optional) – List of columns to exclude from aggregation.</p></li>
<li><p><strong>rename</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code>, optional) – Dictionary to rename columns after incorporation.</p></li>
<li><p><strong>read_method</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">callable</span></code>, optional) – Function used to load the file. Pandas functions like <code class="docutils literal notranslate"><span class="pre">pd.read_csv</span></code> and
<code class="docutils literal notranslate"><span class="pre">pd.read_excel</span></code> are automatically selected based on file extension
(“.csv”, “.xlsx”).</p></li>
<li><p><strong>kw_read</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code>, optional) – <p>Keyword arguments passed to <code class="docutils literal notranslate"><span class="pre">read_method</span></code>. For example, for a “.csv” file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">kw_read</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;header&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;names&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Email&quot;</span><span class="p">,</span> <span class="s2">&quot;PW group&quot;</span><span class="p">]}</span>
<span class="n">kw_read</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;na_values&quot;</span><span class="p">:</span> <span class="s2">&quot;-&quot;</span><span class="p">}</span>
</pre></div>
</div>
</p></li>
<li><p><strong>preprocessing</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">callable</span></code>, optional) – Pre-processing function applied to the <em>DataFrame</em> before incorporation.</p></li>
<li><p><strong>postprocessing</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">callable</span></code>, optional) – Post-processing function applied to the <em>DataFrame</em> after incorporation.</p></li>
<li><p><strong>merge_policy</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>, optional) – <p>Strategy for merging columns with the same name:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">merge</span></code>: Merge only if columns complement each other (NA values).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">replace</span></code>: Use all non-NA values from the file to aggregate.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fill_na</span></code>: Only replace NA values in <code class="docutils literal notranslate"><span class="pre">effectif.xlsx</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">keep</span></code>: Keep the original column from <code class="docutils literal notranslate"><span class="pre">effectif.xlsx</span></code> without changes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">erase</span></code>: Overwrite the column with values from the file to aggregate.</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<ul>
<li><p>Aggregating columns from a CSV file, matching the <code class="docutils literal notranslate"><span class="pre">email</span></code> column in the CSV
with <code class="docutils literal notranslate"><span class="pre">Email</span> <span class="pre">address</span></code> in the central file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">DOCS</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span>
    <span class="s2">&quot;documents/notes.csv&quot;</span><span class="p">,</span>
    <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;Email address&quot;</span><span class="p">,</span>
    <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;email&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Aggregating only the <code class="docutils literal notranslate"><span class="pre">Note</span></code> column:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">DOCS</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span>
    <span class="s2">&quot;documents/notes.csv&quot;</span><span class="p">,</span>
    <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;Email address&quot;</span><span class="p">,</span>
    <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;email&quot;</span>
    <span class="n">subset</span><span class="o">=</span><span class="s2">&quot;Note&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Aggregating and renaming the <code class="docutils literal notranslate"><span class="pre">Note</span></code> column to <code class="docutils literal notranslate"><span class="pre">Note_médian</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">DOCS</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span>
    <span class="s2">&quot;documents/notes.csv&quot;</span><span class="p">,</span>
    <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;Email address&quot;</span><span class="p">,</span>
    <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;email&quot;</span>
    <span class="n">subset</span><span class="o">=</span><span class="s2">&quot;Note&quot;</span><span class="p">,</span>
    <span class="n">rename</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Note&quot;</span><span class="p">:</span> <span class="s2">&quot;Note_médian&quot;</span><span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Aggregating using a CSV without a header:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">DOCS</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span>
    <span class="s2">&quot;documents/notes.csv&quot;</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Email&quot;</span><span class="p">,</span>
    <span class="n">kw_read</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;header&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;names&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Email&quot;</span><span class="p">,</span> <span class="s2">&quot;Grade&quot;</span><span class="p">]},</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Aggregating based on <code class="docutils literal notranslate"><span class="pre">Name</span></code> and <code class="docutils literal notranslate"><span class="pre">Last</span> <span class="pre">name</span></code> using a slug ID to allow for
flexible matching (ignores accents, cases, hyphens, etc.):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">guv.helpers</span><span class="w"> </span><span class="kn">import</span> <span class="n">id_slug</span>
<span class="n">DOCS</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span>
    <span class="s2">&quot;documents/notes.csv&quot;</span><span class="p">,</span>
    <span class="n">left_on</span><span class="o">=</span><span class="n">id_slug</span><span class="p">(</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Last name&quot;</span><span class="p">),</span>
    <span class="n">right_on</span><span class="o">=</span><span class="n">id_slug</span><span class="p">(</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Last name&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Aggregating when the aggregated file has a single column with both names,
while the main file separates them:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">guv.helpers</span><span class="w"> </span><span class="kn">import</span> <span class="n">concat</span>
<span class="n">DOCS</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span>
    <span class="s2">&quot;documents/notes.csv&quot;</span><span class="p">,</span>
    <span class="n">left_on</span><span class="o">=</span><span class="n">concat</span><span class="p">(</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Last name&quot;</span><span class="p">),</span>
    <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;Full_name&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="guv.helpers.Documents.aggregate_jury">
<span class="sig-prename descclassname"><span class="pre">Documents.</span></span><span class="sig-name descname"><span class="pre">aggregate_jury</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#guv.helpers.Documents.aggregate_jury" title="Link to this definition">¶</a></dt>
<dd><p>Aggregates the result of a jury from the task <a class="reference internal" href="tasks.html#guv.tasks.gradebook.XlsGradeBookJury" title="guv.tasks.gradebook.XlsGradeBookJury"><code class="xref py py-class docutils literal notranslate"><span class="pre">XlsGradeBookJury</span></code></a>.</p>
<p>The equivalent using <a class="reference internal" href="#guv.helpers.Documents.aggregate" title="guv.helpers.Documents.aggregate"><code class="xref py py-func docutils literal notranslate"><span class="pre">aggregate()</span></code></a> is written as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">DOCS</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span>
    <span class="s2">&quot;generated/jury_gradebook.xlsx&quot;</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Email&quot;</span><span class="p">,</span>
    <span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Aggregated grade&quot;</span><span class="p">,</span> <span class="s2">&quot;ECTS grade&quot;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – The path to the file to aggregate.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">DOCS</span><span class="o">.</span><span class="n">aggregate_jury</span><span class="p">(</span><span class="s2">&quot;generated/jury_gradebook.xlsx&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="guv.helpers.Documents.aggregate_moodle_grades">
<span class="sig-prename descclassname"><span class="pre">Documents.</span></span><span class="sig-name descname"><span class="pre">aggregate_moodle_grades</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#guv.helpers.Documents.aggregate_moodle_grades" title="Link to this definition">¶</a></dt>
<dd><p>Aggregates grade sheets exported from Moodle.</p>
<p>The grade sheet must be an export of one or more grades from the
Moodle gradebook in the form of an Excel or CSV file.</p>
<p>Unused columns will be removed. Column renaming can be performed
by specifying <code class="docutils literal notranslate"><span class="pre">rename</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – The path to the file to aggregate.</p></li>
<li><p><strong>rename</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code>, optional) – Dictionary to rename columns after incorporation.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">DOCS</span><span class="o">.</span><span class="n">aggregate_moodle_grades</span><span class="p">(</span><span class="s2">&quot;documents/SY02 Notes.xlsx&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="guv.helpers.Documents.aggregate_moodle_groups">
<span class="sig-prename descclassname"><span class="pre">Documents.</span></span><span class="sig-name descname"><span class="pre">aggregate_moodle_groups</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backup</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#guv.helpers.Documents.aggregate_moodle_groups" title="Link to this definition">¶</a></dt>
<dd><p>Aggregates group data from the “Group Choice” activity.</p>
<p>Since the group column is always named “Groupe”, the <code class="docutils literal notranslate"><span class="pre">colname</span></code> argument
allows you to specify a different name. If the column already exists in
the central file, it can be backed up using the <code class="docutils literal notranslate"><span class="pre">backup</span></code> option.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – The path to the file to aggregate.</p></li>
<li><p><strong>colname</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – The column name to store group information in.</p></li>
<li><p><strong>backup</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>) – Save the column before making any changes</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">DOCS</span><span class="o">.</span><span class="n">aggregate_moodle_groups</span><span class="p">(</span><span class="s2">&quot;documents/Paper study groups.xlsx&quot;</span><span class="p">,</span> <span class="s2">&quot;Paper&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="guv.helpers.Documents.aggregate_org">
<span class="sig-prename descclassname"><span class="pre">Documents.</span></span><span class="sig-name descname"><span class="pre">aggregate_org</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">postprocessing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">None</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Operation</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#guv.helpers.Documents.aggregate_org" title="Link to this definition">¶</a></dt>
<dd><p>Aggregation of a file in Org format.</p>
<p>The document to aggregate is in Org format. The headings serve as
keys for aggregation, and the content under those headings is aggregated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Path to the Org file to aggregate.</p></li>
<li><p><strong>colname</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Name of the column in which to store the information
from the Org file.</p></li>
<li><p><strong>on</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>, optional) – Column from the <code class="docutils literal notranslate"><span class="pre">effectif.xlsx</span></code> file used as the key to
aggregate with the headings from the Org file. By default,
the headings must contain the students’ first and last names.</p></li>
<li><p><strong>postprocessing</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">callable</span></code>, optional) – Post-processing to apply to the <em>DataFrame</em> after integrating
the Org file.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<ul>
<li><p>Aggregating a file where the headings are student names:</p>
<p>The Org file:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>* Bob Morane
  Frequently absent
* Untel
  See excuse email
</pre></div>
</div>
<p>The aggregation command:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">DOCS</span><span class="o">.</span><span class="n">aggregate_org</span><span class="p">(</span><span class="s2">&quot;documents/infos.org&quot;</span><span class="p">,</span> <span class="n">colname</span><span class="o">=</span><span class="s2">&quot;Information&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Aggregating a file where the headings match elements from an
existing column. For example, you can aggregate project grades
from an Org file, grouped by project team. Specify the column
containing the project groups, e.g., “Project1_group”.</p>
<p>The Org file:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>* Project1_Group1
  A
* Project1_Group2
  B
</pre></div>
</div>
<p>The aggregation command:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">DOCS</span><span class="o">.</span><span class="n">aggregate_org</span><span class="p">(</span><span class="s2">&quot;documents/infos.org&quot;</span><span class="p">,</span> <span class="n">colname</span><span class="o">=</span><span class="s2">&quot;Project 1 Grade&quot;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;Project1_group&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="guv.helpers.Documents.aggregate_self">
<span class="sig-prename descclassname"><span class="pre">Documents.</span></span><span class="sig-name descname"><span class="pre">aggregate_self</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">columns</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#guv.helpers.Documents.aggregate_self" title="Link to this definition">¶</a></dt>
<dd><p>Aggregation of the central file <code class="docutils literal notranslate"><span class="pre">effectif.xlsx</span></code> itself.</p>
<p>It is sometimes more convenient to manually add or modify columns directly
in the central file <code class="docutils literal notranslate"><span class="pre">effectif.xlsx</span></code> rather than programmatically using
<code class="docutils literal notranslate"><span class="pre">DOCS.aggregate(...)</span></code>, for example. Since <em>guv</em> cannot reliably detect
which columns were manually added or modified, you must specify them explicitly
using the <code class="docutils literal notranslate"><span class="pre">*columns</span></code> argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*columns</strong> (any number of <code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – The manually added or modified columns to retain when updating the
central file.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="directly-modify-base-docs-file">
<h2>Directly modify base <code class="docutils literal notranslate"><span class="pre">DOCS</span></code> file<a class="headerlink" href="#directly-modify-base-docs-file" title="Link to this heading">¶</a></h2>
<dl class="py method">
<dt class="sig sig-object py" id="guv.helpers.Documents.add">
<span class="sig-prename descclassname"><span class="pre">Documents.</span></span><span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kw_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#guv.helpers.Documents.add" title="Link to this definition">¶</a></dt>
<dd><p>Adds a file to the central file</p>
<p>Simply adds the file if the central file does not yet exist. Otherwise, uses the
function <code class="docutils literal notranslate"><span class="pre">func</span></code> to perform the aggregation. The function <code class="docutils literal notranslate"><span class="pre">func</span></code> takes as
arguments the existing <em>DataFrame</em> and the path to the file, and returns the
updated <em>DataFrame</em>. Keywords arguments can be given to <code class="docutils literal notranslate"><span class="pre">func</span></code> using
<code class="docutils literal notranslate"><span class="pre">kw_func</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">func</span></code> is not provided, use either <code class="docutils literal notranslate"><span class="pre">pd.read_csv</span></code> or
<code class="docutils literal notranslate"><span class="pre">pd_read_excel</span></code> based on the extension of the file. Keywords arguments can be
given to <code class="docutils literal notranslate"><span class="pre">pd.read_csv</span></code> or <code class="docutils literal notranslate"><span class="pre">pd_read_excel</span></code> using <code class="docutils literal notranslate"><span class="pre">kw_func</span></code>.</p>
<p>See specialized functions for incorporating standard documents:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#guv.helpers.Documents.aggregate" title="guv.helpers.Documents.aggregate"><code class="xref py py-func docutils literal notranslate"><span class="pre">aggregate()</span></code></a>: CSV/Excel document</p></li>
<li><p><a class="reference internal" href="#guv.helpers.Documents.aggregate_org" title="guv.helpers.Documents.aggregate_org"><code class="xref py py-func docutils literal notranslate"><span class="pre">aggregate_org()</span></code></a>: Org document</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – The path to the file to aggregate.</p></li>
<li><p><strong>func</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">callable</span></code>, optional) – A function with signature <em>DataFrame</em>, filename: str -&gt;
<em>DataFrame</em> that performs the aggregation.</p></li>
<li><p><strong>kw_func</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code>, optional) – Keyword arguments to use with <code class="docutils literal notranslate"><span class="pre">func</span></code> or <code class="docutils literal notranslate"><span class="pre">pd.read_csv</span></code> or
<code class="docutils literal notranslate"><span class="pre">pd.read_excel</span></code>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<ul>
<li><p>Adding data when there is nothing yet:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">DOCS</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;documents/base_listing.xlsx&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Adding data when there is nothing yet with extra keyword arguments:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">DOCS</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;documents/base_listing.xlsx&quot;</span><span class="p">,</span> <span class="n">kw_func</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;encoding&quot;</span><span class="p">:</span> <span class="s2">&quot;ISO_8859_1&quot;</span><span class="p">})</span>
</pre></div>
</div>
</li>
<li><p>Aggregating using a function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">function_that_incorporates</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
    <span class="c1"># Incorporate the file at `file_path` into the DataFrame `df`</span>
    <span class="c1"># and return the updated DataFrame.</span>

<span class="n">DOCS</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;documents/notes.csv&quot;</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">function_that_incorporates</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="guv.helpers.Documents.apply_cell">
<span class="sig-prename descclassname"><span class="pre">Documents.</span></span><span class="sig-name descname"><span class="pre">apply_cell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name_or_email</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#guv.helpers.Documents.apply_cell" title="Link to this definition">¶</a></dt>
<dd><p>Replaces the value of a cell.</p>
<p><code class="docutils literal notranslate"><span class="pre">name_or_email</span></code> is the student’s full name or email address, and <code class="docutils literal notranslate"><span class="pre">colname</span></code>
is the name of the column where the change should be made. The new value is
provided via <code class="docutils literal notranslate"><span class="pre">value</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name_or_email</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – The student’s full name or email address.</p></li>
<li><p><strong>colname</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – The name of the column where the modification should be made.</p></li>
<li><p><strong>value</strong> – The value to assign.</p></li>
<li><p><strong>msg</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>, optional) – A message describing the operation.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">DOCS</span><span class="o">.</span><span class="n">apply_cell</span><span class="p">(</span><span class="s2">&quot;Mark Watney&quot;</span><span class="p">,</span> <span class="s2">&quot;DIY Grade&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="guv.helpers.Documents.apply_column">
<span class="sig-prename descclassname"><span class="pre">Documents.</span></span><span class="sig-name descname"><span class="pre">apply_column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">colname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#guv.helpers.Documents.apply_column" title="Link to this definition">¶</a></dt>
<dd><p>Modifies an existing column using a function.</p>
<p><code class="docutils literal notranslate"><span class="pre">colname</span></code> is the name of an existing column, and <code class="docutils literal notranslate"><span class="pre">func</span></code> is a function
that takes an element from the column as input and returns a modified value.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">msg</span></code> can be provided to describe the operation; it will be displayed
when the aggregation is performed. Otherwise, a generic message will be shown.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>colname</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Name of the column where replacements will be made.</p></li>
<li><p><strong>func</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">callable</span></code>) – Function that takes an element and returns the modified element.</p></li>
<li><p><strong>msg</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>, optional) – A message describing the operation.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">DOCS</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="s2">&quot;note&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">)))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="guv.helpers.Documents.apply_df">
<span class="sig-prename descclassname"><span class="pre">Documents.</span></span><span class="sig-name descname"><span class="pre">apply_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#guv.helpers.Documents.apply_df" title="Link to this definition">¶</a></dt>
<dd><p>Modifies the central file using a function.</p>
<p><code class="docutils literal notranslate"><span class="pre">func</span></code> is a function that takes a <em>DataFrame</em> representing the central file
and returns the modified <em>DataFrame</em>.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">msg</span></code> can be provided to describe what the function does. It will be
displayed when the aggregation is performed. Otherwise, a generic message
will be shown.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">callable</span></code>) – Function that takes a <em>DataFrame</em> and returns a modified <em>DataFrame</em>.</p></li>
<li><p><strong>msg</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>, optional) – A message describing the operation.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<ul>
<li><p>Add a student missing from the official listing:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="n">df_one</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="s2">&quot;Last name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;NICHOLS&quot;</span><span class="p">],</span>
            <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Juliette&quot;</span><span class="p">],</span>
            <span class="s2">&quot;Email&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;juliette.nichols@silo18.fr&quot;</span><span class="p">],</span>
        <span class="p">}</span>
    <span class="p">),</span>
<span class="p">)</span>

<span class="n">DOCS</span><span class="o">.</span><span class="n">apply_df</span><span class="p">(</span><span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">df</span><span class="p">,</span> <span class="n">df_one</span><span class="p">)))</span>
</pre></div>
</div>
</li>
<li><p>Remove duplicate students:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">DOCS</span><span class="o">.</span><span class="n">apply_df</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;Email&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">(),</span> <span class="p">:],</span>
    <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Remove duplicate students&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="guv.helpers.Documents.compute_new_column">
<span class="sig-prename descclassname"><span class="pre">Documents.</span></span><span class="sig-name descname"><span class="pre">compute_new_column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#guv.helpers.Documents.compute_new_column" title="Link to this definition">¶</a></dt>
<dd><p>Creating a column from other columns</p>
<p>The columns required for the calculation are specified in <code class="docutils literal notranslate"><span class="pre">cols</span></code>.
In case you want to change the column used for the calculation
without modifying the <code class="docutils literal notranslate"><span class="pre">func</span></code> function, you can provide a
tuple <code class="docutils literal notranslate"><span class="pre">(&quot;col&quot;,</span> <span class="pre">&quot;other_col&quot;)</span></code> where <code class="docutils literal notranslate"><span class="pre">col</span></code> is the name used in
<code class="docutils literal notranslate"><span class="pre">func</span></code> and <code class="docutils literal notranslate"><span class="pre">other_col</span></code> is the actual column used.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">func</span></code> function that computes the new column receives a Pandas
<em>Series</em> of all the values from the specified columns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*cols</strong> (list of <code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – List of columns provided to the <code class="docutils literal notranslate"><span class="pre">func</span></code> function</p></li>
<li><p><strong>func</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">callable</span></code>) – Function that takes a dictionary of “column names/values”
as input and returns a computed value</p></li>
<li><p><strong>colname</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Name of the column to create</p></li>
<li><p><strong>msg</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>, optional) – A message describing the operation</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<ul>
<li><p>Weighted average of two grades:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">average</span><span class="p">(</span><span class="n">grades</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">.4</span> <span class="o">*</span> <span class="n">grades</span><span class="p">[</span><span class="s2">&quot;Note_médian&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mf">.6</span> <span class="o">*</span> <span class="n">grades</span><span class="p">[</span><span class="s2">&quot;Note_final&quot;</span><span class="p">]</span>

<span class="n">DOCS</span><span class="o">.</span><span class="n">compute_new_column</span><span class="p">(</span><span class="s2">&quot;Note_médian&quot;</span><span class="p">,</span> <span class="s2">&quot;Note_final&quot;</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">average</span><span class="p">,</span> <span class="n">colname</span><span class="o">=</span><span class="s2">&quot;Note_moyenne&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Average ignoring undefined values:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">average</span><span class="p">(</span><span class="n">grades</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">grades</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">DOCS</span><span class="o">.</span><span class="n">compute_new_column</span><span class="p">(</span><span class="s2">&quot;note1&quot;</span><span class="p">,</span> <span class="s2">&quot;note2&quot;</span><span class="p">,</span> <span class="s2">&quot;note3&quot;</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">average</span><span class="p">,</span> <span class="n">colname</span><span class="o">=</span><span class="s2">&quot;Note_moyenne&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Recalculation with a modified grade without redefining the <code class="docutils literal notranslate"><span class="pre">average</span></code> function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">DOCS</span><span class="o">.</span><span class="n">compute_new_column</span><span class="p">(</span>
    <span class="p">(</span><span class="s2">&quot;note1&quot;</span><span class="p">,</span> <span class="s2">&quot;note1_fix&quot;</span><span class="p">),</span> <span class="s2">&quot;note2&quot;</span><span class="p">,</span> <span class="s2">&quot;note3&quot;</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">average</span><span class="p">,</span> <span class="n">colname</span><span class="o">=</span><span class="s2">&quot;Note_moyenne (fix)&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="guv.helpers.Documents.fillna_column">
<span class="sig-prename descclassname"><span class="pre">Documents.</span></span><span class="sig-name descname"><span class="pre">fillna_column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">colname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">na_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#guv.helpers.Documents.fillna_column" title="Link to this definition">¶</a></dt>
<dd><p>Replaces undefined values in the <code class="docutils literal notranslate"><span class="pre">colname</span></code> column</p>
<p>Only one of the options <code class="docutils literal notranslate"><span class="pre">na_value</span></code> and <code class="docutils literal notranslate"><span class="pre">group_column</span></code> should be
specified. If <code class="docutils literal notranslate"><span class="pre">na_value</span></code> is specified, values are unconditionally
replaced with the provided value. If <code class="docutils literal notranslate"><span class="pre">group_column</span></code> is specified,
values are filled by grouping on <code class="docutils literal notranslate"><span class="pre">group_column</span></code> and using the only
valid value in that column per group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>colname</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Name of the column where <code class="docutils literal notranslate"><span class="pre">NA</span></code> values will be replaced</p></li>
<li><p><strong>na_value</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>, optional) – Value to replace undefined values with</p></li>
<li><p><strong>group_column</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>, optional) – Name of the column used for grouping</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<ul>
<li><p>Replace undefined entries in the <code class="docutils literal notranslate"><span class="pre">note</span></code> column with
“ABS”:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">DOCS</span><span class="o">.</span><span class="n">fillna_column</span><span class="p">(</span><span class="s2">&quot;note&quot;</span><span class="p">,</span> <span class="n">na_value</span><span class="o">=</span><span class="s2">&quot;ABS&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Replace undefined entries within each group identified by the
<code class="docutils literal notranslate"><span class="pre">groupe_projet</span></code> column with the only defined value in that group:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">DOCS</span><span class="o">.</span><span class="n">fillna_column</span><span class="p">(</span><span class="s2">&quot;note_projet&quot;</span><span class="p">,</span> <span class="n">group_column</span><span class="o">=</span><span class="s2">&quot;groupe_projet&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="guv.helpers.Documents.flag">
<span class="sig-prename descclassname"><span class="pre">Documents.</span></span><span class="sig-name descname"><span class="pre">flag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename_or_string</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">colname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flags</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['Oui',</span> <span class="pre">'']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#guv.helpers.Documents.flag" title="Link to this definition">¶</a></dt>
<dd><p>Flag a list of students in a new column</p>
<p>The document to aggregate is a list of student names displayed
line by line.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename_or_string</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Path to the file to aggregate, or the file content as a string.</p></li>
<li><p><strong>colname</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Name of the column in which to place the flag.</p></li>
<li><p><strong>flags</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>, optional) – The two flag values used, default is “Yes” and empty.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Aggregating a file with student names as header:</p>
<p>The file “tiers_temps.txt”:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># Comments
Bob Morane

# Robust to circular permutation and case
aRcTor BoB
</pre></div>
</div>
<p>The aggregation instruction:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">DOCS</span><span class="o">.</span><span class="n">flag</span><span class="p">(</span><span class="s2">&quot;documents/tiers_temps.txt&quot;</span><span class="p">,</span> <span class="n">colname</span><span class="o">=</span><span class="s2">&quot;Tiers-temps&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="guv.helpers.Documents.replace_column">
<span class="sig-prename descclassname"><span class="pre">Documents.</span></span><span class="sig-name descname"><span class="pre">replace_column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">colname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rep_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_colname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backup</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#guv.helpers.Documents.replace_column" title="Link to this definition">¶</a></dt>
<dd><p>Replacements in a column</p>
<p>Replaces values specified in <code class="docutils literal notranslate"><span class="pre">rep_dict</span></code> in the column
<code class="docutils literal notranslate"><span class="pre">colname</span></code>.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">backup</span></code> argument is provided, the column is saved
before any modification (with a <code class="docutils literal notranslate"><span class="pre">_orig</span></code> suffix). If
the <code class="docutils literal notranslate"><span class="pre">new_colname</span></code> argument is provided, the column is copied
to a new column named <code class="docutils literal notranslate"><span class="pre">new_colname</span></code> and changes are made on
this new column.</p>
<p>A message <code class="docutils literal notranslate"><span class="pre">msg</span></code> can be specified to describe what the function
does; it will be displayed when the aggregation is performed.
Otherwise, a generic message will be shown.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>colname</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Name of the column in which to perform replacements</p></li>
<li><p><strong>rep_dict</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code>) – Dictionary of replacements</p></li>
<li><p><strong>new_colname</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Name of the new column</p></li>
<li><p><strong>backup</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>) – Save the column before making any changes</p></li>
<li><p><strong>msg</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>, optional) – A message describing the operation</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">DOCS</span><span class="o">.</span><span class="n">replace_column</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;TD 1&quot;</span><span class="p">:</span> <span class="s2">&quot;TD1&quot;</span><span class="p">,</span> <span class="s2">&quot;TD 2&quot;</span><span class="p">:</span> <span class="s2">&quot;TD2&quot;</span><span class="p">})</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ECTS_TO_NUM</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;A&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="s2">&quot;B&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s2">&quot;D&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s2">&quot;E&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;F&quot;</span><span class="p">:</span> <span class="mi">0</span>
<span class="p">}</span>
<span class="n">DOCS</span><span class="o">.</span><span class="n">replace_column</span><span class="p">(</span><span class="s2">&quot;Note_TP&quot;</span><span class="p">,</span> <span class="n">ECTS_TO_NUM</span><span class="p">,</span> <span class="n">backup</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="guv.helpers.Documents.replace_regex">
<span class="sig-prename descclassname"><span class="pre">Documents.</span></span><span class="sig-name descname"><span class="pre">replace_regex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">colname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">reps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_colname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backup</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#guv.helpers.Documents.replace_regex" title="Link to this definition">¶</a></dt>
<dd><p>Regex replacements in a column</p>
<p>Replaces, in the <code class="docutils literal notranslate"><span class="pre">colname</span></code> column, all occurrences matching the regular
expressions specified in <code class="docutils literal notranslate"><span class="pre">reps</span></code>.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">backup</span></code> argument is provided, the column is saved before any
modification (with a <code class="docutils literal notranslate"><span class="pre">_orig</span></code> suffix). If the <code class="docutils literal notranslate"><span class="pre">new_colname</span></code> argument is
provided, the column is copied to a new column named <code class="docutils literal notranslate"><span class="pre">new_colname</span></code> and the
modifications are applied to that new column.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">msg</span></code> message can be specified to describe what the function does; it will
be displayed when the aggregation is performed. Otherwise, a generic message
will be shown.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>colname</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Name of the column in which to perform replacements</p></li>
<li><p><strong>*reps</strong> (any number of <code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code>) – Pairs of regex / replacement</p></li>
<li><p><strong>new_colname</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Name of the new column</p></li>
<li><p><strong>backup</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>) – Save the column before making any changes</p></li>
<li><p><strong>msg</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>, optional) – A message describing the operation</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">DOCS</span><span class="o">.</span><span class="n">replace_regex</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;group([0-9])&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;G\1&quot;</span><span class="p">),</span> <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;g([0-9])&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;G\1&quot;</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="guv.helpers.Documents.switch">
<span class="sig-prename descclassname"><span class="pre">Documents.</span></span><span class="sig-name descname"><span class="pre">switch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename_or_string</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">colname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backup</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_colname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#guv.helpers.Documents.switch" title="Link to this definition">¶</a></dt>
<dd><p>Performs value swaps in a column</p>
<p>The <code class="docutils literal notranslate"><span class="pre">colname</span></code> argument specifies the column in which to perform
the swaps. If the <code class="docutils literal notranslate"><span class="pre">backup</span></code> argument is provided, the column is
saved before any modification (with a <code class="docutils literal notranslate"><span class="pre">_orig</span></code> suffix). If the
<code class="docutils literal notranslate"><span class="pre">new_colname</span></code> argument is provided, the column is copied to a new
column named <code class="docutils literal notranslate"><span class="pre">new_colname</span></code> and the modifications are applied to
this new column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename_or_string</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Path to the file to aggregate, or the content of the file as a string.</p></li>
<li><p><strong>colname</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Name of the column where the changes will be applied</p></li>
<li><p><strong>backup</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code>) – Save the column before making any changes</p></li>
<li><p><strong>new_colname</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>) – Name of the new column</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">DOCS</span><span class="o">.</span><span class="n">switch</span><span class="p">(</span><span class="s2">&quot;fichier_échange_TP&quot;</span><span class="p">,</span> <span class="n">colname</span><span class="o">=</span><span class="s2">&quot;TP&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">DOCS</span><span class="o">.</span><span class="n">switch</span><span class="p">(</span><span class="s2">&quot;Dupont --- Dupond&quot;</span><span class="p">,</span> <span class="n">colname</span><span class="o">=</span><span class="s2">&quot;TP&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          <a class="prev-page" href="tasks.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Tasks</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Sylvain Rousseau
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Aggregating functions for <code class="docutils literal notranslate"><span class="pre">DOCS</span></code></a><ul>
<li><a class="reference internal" href="#aggregating-file-to-base-docs-file">Aggregating file to base <code class="docutils literal notranslate"><span class="pre">DOCS</span></code> file</a><ul>
<li><a class="reference internal" href="#guv.helpers.Documents.aggregate"><code class="docutils literal notranslate"><span class="pre">Documents.aggregate()</span></code></a></li>
<li><a class="reference internal" href="#guv.helpers.Documents.aggregate_jury"><code class="docutils literal notranslate"><span class="pre">Documents.aggregate_jury()</span></code></a></li>
<li><a class="reference internal" href="#guv.helpers.Documents.aggregate_moodle_grades"><code class="docutils literal notranslate"><span class="pre">Documents.aggregate_moodle_grades()</span></code></a></li>
<li><a class="reference internal" href="#guv.helpers.Documents.aggregate_moodle_groups"><code class="docutils literal notranslate"><span class="pre">Documents.aggregate_moodle_groups()</span></code></a></li>
<li><a class="reference internal" href="#guv.helpers.Documents.aggregate_org"><code class="docutils literal notranslate"><span class="pre">Documents.aggregate_org()</span></code></a></li>
<li><a class="reference internal" href="#guv.helpers.Documents.aggregate_self"><code class="docutils literal notranslate"><span class="pre">Documents.aggregate_self()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#directly-modify-base-docs-file">Directly modify base <code class="docutils literal notranslate"><span class="pre">DOCS</span></code> file</a><ul>
<li><a class="reference internal" href="#guv.helpers.Documents.add"><code class="docutils literal notranslate"><span class="pre">Documents.add()</span></code></a></li>
<li><a class="reference internal" href="#guv.helpers.Documents.apply_cell"><code class="docutils literal notranslate"><span class="pre">Documents.apply_cell()</span></code></a></li>
<li><a class="reference internal" href="#guv.helpers.Documents.apply_column"><code class="docutils literal notranslate"><span class="pre">Documents.apply_column()</span></code></a></li>
<li><a class="reference internal" href="#guv.helpers.Documents.apply_df"><code class="docutils literal notranslate"><span class="pre">Documents.apply_df()</span></code></a></li>
<li><a class="reference internal" href="#guv.helpers.Documents.compute_new_column"><code class="docutils literal notranslate"><span class="pre">Documents.compute_new_column()</span></code></a></li>
<li><a class="reference internal" href="#guv.helpers.Documents.fillna_column"><code class="docutils literal notranslate"><span class="pre">Documents.fillna_column()</span></code></a></li>
<li><a class="reference internal" href="#guv.helpers.Documents.flag"><code class="docutils literal notranslate"><span class="pre">Documents.flag()</span></code></a></li>
<li><a class="reference internal" href="#guv.helpers.Documents.replace_column"><code class="docutils literal notranslate"><span class="pre">Documents.replace_column()</span></code></a></li>
<li><a class="reference internal" href="#guv.helpers.Documents.replace_regex"><code class="docutils literal notranslate"><span class="pre">Documents.replace_regex()</span></code></a></li>
<li><a class="reference internal" href="#guv.helpers.Documents.switch"><code class="docutils literal notranslate"><span class="pre">Documents.switch()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    </body>
</html>